#!/usr/bin/env python3

import sys
import subprocess
import json
from functions import *




if sys.argv[1] == "diff":
    
    #Generating diff for two directories
    if( len(sys.argv) < 3 ):
        raise Exception("Please input base directory.")
    elif( len(sys.argv) < 4 ):
        raise Exception("Please input directory to be compared with.")


    base_dir = sys.argv[2]
    comp_dir = sys.argv[3]


    #diffing
    dir_diff_object = generate_dir_diffs( base_dir, comp_dir )

    if len(sys.argv) > 4:
        filepath = sys.argv[4]
        file = open(filepath, "w")
        json.dump(dir_diff_object, file)
        file.close()
    else:
        print(dir_diff_object)








if sys.argv[1] == "patch":
    
    #patching
    if len(sys.argv) < 3:
        raise Exception("Please input directory to be patched.")
    elif len(sys.argv) < 4:
        raise Exception("Please input patch file.")
    
